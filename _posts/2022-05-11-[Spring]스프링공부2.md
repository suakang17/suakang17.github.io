---
layout: post
title:  "[Spring]스프링공부02"
date:   2022-05-12 15:33:24 +0900
categories: Study
published: False
---

# [Spring] Spring02 - Spring Boot 웹 개발 방식과 어노테이션(Java)

<img src='/assets/img/docs/springlogo.svg' />  

스프링에서의 웹 개발 방식에 대해 공부했다.

## 정적 컨텐츠

스프링부트는 정적 컨텐츠 기능을 자동으로 제공한다.  
띄우고 싶은 이미 만들어진 정적 컨텐츠를 src 하위의 static폴더에 저장을 하면 되는데 (`src/main/resources/static`), 말 그대로 '정적'이기에 이 파일에 대한 어떤 프로그래밍을 할 수는 없다.  
따라서 서버에서 정적 컨텐츠를 반환할 때 파일을 그대로 전달하는 것이다.  

예시로 웹 브라우저에서 localhost:8080에 '파일명'을 입력하면 내장 톰캣서버가 요청을 받아 '해당 파일명'이라는 요청이 왔다고 스프링에게 넘긴다.  
스프링은 우선 순위를 가지는 Controller에서 파일명과 일치하는 Controller가 있는지 확인한다. 
관련 컨트롤러가 없는 경우 파일명과 일치하는 파일을 찾아 그대로 반환해준다.  
## MVC - 전통적인 MVC 방식
한 마디로 서버측에서 페이지를 랜더링하는 방식으로 웹 애플리케이션을 구축하는 것이다. 
다음은 가장 잘 이해된 MVC에 대한 설명이다.  

> 스프링 MVC에서는 웹 요청을 처리하기 위해 DispatcherServlet이라는 서블릿 객체를 활용하는데, 이 서블릿은 스프링을 이용하여 개발된 웹 애플리케이션에 전송되는 요청을 가장 먼저 받아 요청을 처리할 수 있는 컨트롤러로 전달하고 그 결과를 기반으로 클라이언트에 전달할 응답(View)을 생성, 반환하는 역할을 수행한다. [출처 블로그](https://velog.io/@park2348190/Spring-MVC%EC%9D%98-%EB%8F%99%EC%9E%91)  

<img src='/assets/img/docs/springstudy2_2.png' />

- Model: 실제 소스 코드를 통해 어떤한 동작이 수행되는 부분  
- View: 반환되어 보여지는 화면(display or presenation)으로, html이 중심이 되는 jsp를 사용하는데 요즘에는 템플릿 엔진으로 대체되어가는 중.(스프링부트에서는 jsp를 기본으로 지원하지 않는다고 한다.)
    - ViewResolver == 템플릿 엔진(Thymeleaf etc..): API로 통신하지 않는 경우는 view를 랜더링 해야 하므로(데이터를 직접 내려주는 방식이 아니므로) 이 때의 view를 선택하는 것
- Controller: view, model 사이의 인터페이스역할로 둘을 연결하고 제어한다. view의 요청에 따라 model의 상태를 바꾸고, 이걸 다시 view에 전달하는 식. 

Controller의 핸들러 매서드가 값을 반환하면 이를 기반으로 ViewResolver가 해당하는 View를 찾아 렌더링한 뒤, Http 응답으로 전달한다.
## MVC - API 방식
JSON 형식의 데이터를 응답으로 제공하는 방식이다.  

@ResponseBody 어노테이션은 http통신 프로토콜의 body부에 데이터를 직접 넣어주겠다라는 뜻으로, api 방식을 사용하면 view(html)대신 httpmessageconverter가 동작하며 뭘 받았는지에 따라 처리하는 방식이 다르다. (이 때의 Controller는 @RestController를 붙인다. ~~@Controller~~)  
문자를 받는 경우 stringconverter가 문자 그대로 반환하며, 객체를 받는 경우 jsonconverter가 JSON방식으로 데이터를 만들어 응답에 반환한다.  

## 어노테이션 Annotation이란?

> 자바 애너테이션은 자바 소스 코드에 추가하여 사용할 수 있는 메타데이터의 일종이다. 보통 @ 기호를 앞에 붙여서 사용한다. JDK 1.5 버전 이상에서 사용 가능하다. 자바 애너테이션은 클래스 파일에 임베디드되어 컴파일러에 의해 생성된 후 자바 가상머신에 포함되어 작동한다.  -위키백과

내가 이해한 바로는 어노테이션은 작성하는 자바 코드에 대한 "설정파일"이다.  
따로 설정파일을 두어 별개로 관리하여 코드와 설정이 버전이 맞지 않는 문제 등이 발생해서 하나의 파일에서 자바 코드와 설정을 관리하게 한 것이다.  

- 어노테이션의 종류
    - 내장 어노테이션: Java에서 제공해주는 기본 어노테이션(JDK 내장)
        - @Override: 해당 매서드가 부모 클래스를 overriding 할 때, 컴파일러에게 문법 체크하도록 시킨다.(실수 방지 용도)
        - @Deprecated: '구식화', 즉, 앞으로 사용하지 않을 것을 권장하는 필드나 메서드에 붙인다.차후에 없어질 수도 있다는 것을 의미한다.
        - @SuppressWarnings: 컴파일러에 나타나는 경고메시지를 제거한다.

    - 메타 어노테이션: 어노테이션을 위한 어노테이션
        - @Retention: 어노테이션이 유지되는 기간을 지정하는데 사용한다.(라이프사이클 설정)
        - @Documented: javadoc으로 작성한 문서에 포함시키려면 해당 어노테이션을 붙인다.
        - @Target: 어노테이션을 정의할 때, 적용될 대상을 지정하는데 사용한다. 
        - @Inherited: 어노테이션을 자손 클래스에 상속시킬 때 사용한다.
        - @Repeatable: 중복하여 붙일 수 있는 어노테이션을 정의할 때 사용한다.

    - 사용자 정의 어노테이션: 사용자가 직접 정의한 어노테이션
        - 주로 스프링에서 의존성 주입(@Autowired), 역할 정의(@Service)등의 용도로 활용한다고 한다.


드디어 내가 하고 있는게 뭔지 이해가 가기 시작했다.  
구조를 대강이라도 알고 시작해야 좀 더 효율적으로 공부할 수 있겠지 싶어 며칠을 구글링한건데 정말 잘했다.