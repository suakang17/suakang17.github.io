---
layout: post
title:  "[Study] 6회차 미션"
date:   2023-03-28 12:05:52 +0900
categories: Study
published: false
---

# [Study] 7회차 미션

7회차 미션을 진행해보자!  
전체 코드는 [여기](링크 추가하기)에서 확인할 수 있다. 

이번 미션 요구사항은 아래와 같다.
- Store entity, table 생성
    - id
    - name
    - address: 도로명, 상세주소 포함
    - tel
- Store API
    - 상점 등록
    - 전체 상점 조회
    - 상세 상점 조회 (id값)
    - 하나의 상점에 속한 모든 상품 조회
- Store와 Product은 1:N 관계

작년에 스프링을 처음 다룰 때 봤던 임베디드, 임베더블과(address) 테이블 간 관계(store:product)를 다시 다뤄보게 되었다. 

### 고민

1. 엔티티의 각 항목 db 타입을 어떻게 결정해야할지에 대한 고민

2. 일대다 다대일 관계에 대한 고민

3. 테스트에 대한 고민 

### Product - Store 객체간의 관계
요구사항을 읽었을 때 "하나의 상점은 여러개의 상품을 가질 수 있습니다."라는 문장을 읽고 상점:상품 = 1:N 으로 매핑하면 되겠다고 생각했다.  
ERD cloud를 통해 테이블을 만들다 보니 다시 1:N이 맞는지에 대한 고민이 생겼다. (N:M은 아닐까)  
검색한 결과 연관관계 매핑시 고려사항은 크게 3가지가 있다고 한다.

- 객체 참조의 방향성: 단방향, 양방향 
- 연관 관계의 주인: 양방향일 때, 연관 관계에서 관리 주체
- 다중성 : 다대일(N:1), 일대다(1:N), 일대일(1:1), 다대다(N:M) 

방향성을 따질 때, DB table이 아닌 객체를 고려한다. 객체는 참조용 필드가 존재해야만 다른 객체를 참조할 수 있기 때문이라고 한다.
비즈니스 로직에 따라 선택하면 된다.  

미션의 경우 "하나의 상점에 속하는 모든 상품 조회"가 가능해야했고, "하나의 상품이 등록된 모든 상점 조회"에 대한 요구사항은 없었기에 "상점 &rightarrow; 상품"의 단방향으로 결론내렸다.  

단방향이므로 연관 관계의 주인은 넘기고, 다중성에 대해 생각해보자.  
다중성은 객체가 아닌 DB 기준이라고 한다.

- 하나의 상점(1)에 속하는 모든 상품(N) 조회 API
- 하나의 상점(1)은 여러개의 상품(N)을 가질 수 있다

&rarr; 따라서, 상품(N) : 상점(1)의 다대일 관계를 갖는다.  
외래키를 상품(N)이 관리한다.  
(DB는 무조건 다(N)쪽이 외래 키를 갖는다고 한다. 왜일까?) 

### 1:N 단방향이 아닌 이유
실무에서는 일대다 단방향은 거의 쓰지 않는다고 한다. 
